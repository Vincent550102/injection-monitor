(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5465:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var n=a(9517);a(9712);var l=a(8838),s=a(2164),r=a(3123),i=a(5187),o=a(8650),c=a(9686),d=a(3736),u=a(3764),h=a(5598),x=a(6533);function g(e){let{placeholder:t}=e;return(0,n.jsx)("button",{type:"button",className:"inline-flex items-center group",onClick:()=>navigator.clipboard.writeText(t),children:(0,n.jsx)("code",{className:"cursor-pointer bg-gray-200 dark:bg-neutral-700 rounded px-1 font-mono text-xs transition-all group-hover:bg-gray-300 dark:group-hover:bg-neutral-600 group-active:bg-gray-400 dark:group-active:bg-neutral-500 group-active:translate-y-px",children:t})})}function p(){let[e,t]=(0,l.useState)(""),[a,r]=(0,l.useState)([""]),[i,o]=(0,l.useState)("auto"),c=(0,l.useMemo)(()=>{let t=e,n=e.includes("{{INJECT}}");return a.forEach((e,a)=>{let l=0===a?"{{INJECT}}":"{{INJECT".concat(a+1,"}}");t.includes(l)?t=t.split(l).join(e):0!==a||n||(t="".concat(t," ").concat(e))}),t.trim()},[e,a]),d=(0,l.useMemo)(()=>(function(e){let t=[],a=[],n=!1,l=!1,s=!1,r=!1;for(let i=0;i<e.length;i++){let o=e[i],c=e[i+1],d=e[i-1];if(!n&&!l&&!s){if(!r&&"/"===o&&"*"===c){r=!0,i++;continue}if(r&&"*"===o&&"/"===c){r=!1,i++;continue}if(r)continue}if(!n&&!l&&!s&&("/"===o&&"/"===c||"-"===o&&"-"===c||"#"===o&&"\\"!==d)){for(;i<e.length&&"\n"!==e[i];)i++;continue}if(!l&&!s&&"'"===o){n=!n;continue}if(!n&&!s&&'"'===o){l=!l;continue}if(!n&&!l&&"`"===o){s=!s;continue}if(!n&&!l&&!s){if("({[".includes(o))t.push(o);else if(")}]".includes(o)){let e=t.pop();e?({"(":")","[":"]","{":"}"})[e]!==o&&a.push("Mismatched ".concat(e," and ").concat(o," at position ").concat(i)):a.push("Extra closing ".concat(o," at position ").concat(i))}}}return t.length&&a.push("Not all brackets are closed"),n&&a.push("Single quote is not closed"),l&&a.push("Double quote is not closed"),s&&a.push("Backtick is not closed"),r&&a.push("Block comment is not closed"),{balanced:0===a.length,problems:a}})(c),[c]),u=(0,l.useMemo)(()=>{if(!c.trim())return{html:"",lang:""};if("auto"===i){let e=s.A.highlightAuto(c);return{html:e.value,lang:e.language||"unknown"}}try{return{html:s.A.highlight(c,{language:i}).value,lang:i}}catch(t){let e=s.A.highlightAuto(c);return{html:e.value,lang:e.language||"unknown"}}},[c,i]),h=u.html,x=u.lang;return(0,n.jsxs)("main",{className:"min-h-screen p-8 flex flex-col gap-8 bg-gray-100 dark:bg-neutral-900 mx-auto max-w-4xl",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Injection Monitor"}),(0,n.jsx)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:"Real-time command injection monitor with syntax highlighting and balance analysis."}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,n.jsxs)("div",{className:"flex flex-col flex-1 gap-2",children:[(0,n.jsx)("label",{className:"font-medium",children:"Command"}),(0,n.jsx)("textarea",{className:"p-2 rounded border resize-y min-h-[120px] dark:bg-neutral-800 dark:text-white",value:e,onChange:e=>t(e.target.value),placeholder:"e.g. dig '{{INJECT}}';"}),(0,n.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Insert placeholder like"," ",(0,n.jsx)(g,{placeholder:"{{INJECT}}"})," or"," ",(0,n.jsx)(g,{placeholder:"{{INJECT2}}"})," ... to specify position. If no placeholder exists, the first injection will append to the end."]})]}),(0,n.jsxs)("div",{className:"flex flex-col flex-1 gap-2",children:[(0,n.jsx)("label",{className:"font-medium",children:"Injection List"}),a.map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("textarea",{className:"p-2 rounded border resize-y min-h-[80px] dark:bg-neutral-800 dark:text-white",value:e,onChange:e=>{var a;return a=e.target.value,void r(e=>{let n=[...e];return n[t]=a,n})},placeholder:0===t?"e.g. '; whoami;'":"Injection ".concat(t+1)}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(g,{placeholder:0===t?"{{INJECT}}":"{{INJECT".concat(t+1,"}}")}),a.length>1&&(0,n.jsx)("button",{type:"button",className:"text-red-500 text-xs hover:underline",onClick:()=>{r(e=>1===e.length?e:e.filter((e,a)=>a!==t))},children:"Delete"})]})]},t)),(0,n.jsx)("button",{type:"button",className:"mt-2 self-start text-sm bg-gray-200 dark:bg-neutral-700 px-2 py-1 rounded hover:bg-gray-300 dark:hover:bg-neutral-600 transition-colors",onClick:()=>r(e=>[...e,""]),children:"+ Add Injection"})]})]}),(0,n.jsxs)("section",{className:"flex flex-col gap-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Analysis Result"}),d.balanced?(0,n.jsx)("p",{className:"text-green-600",children:"Balanced: OK âœ…"}):(0,n.jsx)("ul",{className:"list-disc pl-6 text-red-600",children:d.problems.map(e=>(0,n.jsx)("li",{children:e},e))})]}),(0,n.jsxs)("section",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Syntax Highlight"}),(0,n.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"border rounded p-1 text-sm dark:bg-neutral-800 dark:text-white",children:[(0,n.jsx)("option",{value:"auto",children:"Auto"}),(0,n.jsx)("option",{value:"javascript",children:"JavaScript"}),(0,n.jsx)("option",{value:"typescript",children:"TypeScript"}),(0,n.jsx)("option",{value:"python",children:"Python"}),(0,n.jsx)("option",{value:"bash",children:"Bash"}),(0,n.jsx)("option",{value:"sql",children:"SQL"}),(0,n.jsx)("option",{value:"java",children:"Java"}),(0,n.jsx)("option",{value:"go",children:"Go"}),(0,n.jsx)("option",{value:"json",children:"JSON"})]})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Detected language: ",x||"N/A"]}),(0,n.jsx)("pre",{className:"rounded bg-neutral-900 text-white overflow-auto p-4",children:(0,n.jsx)("code",{className:"hljs",dangerouslySetInnerHTML:{__html:h||"// no content"}})})]}),(0,n.jsxs)("footer",{className:"mt-12 border-t pt-4 flex flex-col items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,n.jsxs)("span",{children:["Made by"," ",(0,n.jsx)("a",{href:"https://vincent55.tw",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-blue-600",children:"Vincent55"})]}),(0,n.jsxs)("a",{href:"https://github.com/Vincent550102/injection-monitor/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-blue-600",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4","aria-hidden":"true",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.477 2 12c0 4.418 2.867 8.166 6.839 9.489.5.091.682-.217.682-.483 0-.237-.009-.868-.014-1.703-2.782.604-3.369-1.343-3.369-1.343-.454-1.154-1.11-1.462-1.11-1.462-.907-.62.069-.607.069-.607 1.002.07 1.53 1.03 1.53 1.03.892 1.528 2.341 1.087 2.91.832.091-.647.35-1.087.636-1.337-2.222-.253-4.555-1.111-4.555-4.944 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.272.098-2.65 0 0 .84-.269 2.75 1.025A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337 1.909-1.294 2.748-1.025 2.748-1.025.546 1.378.203 2.397.1 2.65.64.699 1.028 1.592 1.028 2.683 0 3.842-2.337 4.687-4.566 4.936.359.309.678.92.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.013 10.013 0 0 0 22 12c0-5.523-4.477-10-10-10Z",clipRule:"evenodd"})}),(0,n.jsx)("span",{children:"GitHub Repo"})]})]})]})}s.A.registerLanguage("javascript",r.A),s.A.registerLanguage("typescript",i.A),s.A.registerLanguage("python",o.A),s.A.registerLanguage("bash",c.A),s.A.registerLanguage("sql",d.A),s.A.registerLanguage("java",u.A),s.A.registerLanguage("go",h.A),s.A.registerLanguage("json",x.A)},7092:(e,t,a)=>{Promise.resolve().then(a.bind(a,5465))}},e=>{e.O(0,[61,584,883,244,358],()=>e(e.s=7092)),_N_E=e.O()}]);